{% extends 'nav.html.twig' %}

{% block title %}Tableau de bord{% endblock %}


   {% block stylesheets %}
       <link rel="stylesheet" href="{{ asset('/assets/css/pro/mdb.min.css') }}" />
   {% endblock %}


{% block content %}


    <section class="mt-md-4 pt-md-2 mb-5 pb-4">

        <!-- Grid row -->
        <div class="row">


            <!-- Grid column -->
            <div class="col-xl-12 col-md-12 mb-xl-0 mb-5">

                <!-- Card -->
                <div class="card card-cascade cascading-admin-card">

                    <!-- Card Data -->
                    <div class="admin-up">
                        <i class="fas fa-users primary-color mr-3 z-depth-2"></i>
                        <div class="data">
                            <p class="text-uppercase">effectif total</p>
                            <h4 class="font-weight-bold dark-grey-text">{{ militaires | length }}</h4>
                        </div>
                    </div>

                    <!-- Card content -->
                    <div class="card-body card-body-cascade">
                        <div class="progress mb-3">
                            <div class="progress-bar bg-primary" role="progressbar" style="width: 100%" aria-valuenow="100"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <p class="card-text">Effectif des elements a ce jour</p>
                    </div>

                </div>
                <!-- Card -->

            </div>


            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-xl-3 col-md-6 mb-xl-0 mb-4 mt-4">

                <!-- Card -->
                <div class="card card-cascade cascading-admin-card">

                    <!-- Card Data -->
                    <div class="admin-up">
                        <i class="fas fa-chart-line success-color mr-3 z-depth-2"></i>
                        <div class="data">
                            <p class="text-uppercase">En service</p>
                            <h4 class="font-weight-bold dark-grey-text">{{ militaire_service | length }}</h4>
                        </div>
                    </div>

                    <!-- Card content -->
                    <div class="card-body card-body-cascade">
                        <div class="progress mb-3">
                            {% set en_servie  = (militaire_service|length / militaires|length)*100 %}
                            <div class="progress-bar green accent-2" role="progressbar" style="width: {{ en_servie|round(1, 'ceil') }}%" aria-valuenow="25"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <p class="card-text">{{ en_servie|round(1, 'ceil') }}% de l'effectif total</p>
                    </div>

                </div>
                <!-- Card -->

            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-xl-3 col-md-6 mb-md-0 mb-4  mt-4">

                <!-- Card -->
                <div class="card card-cascade cascading-admin-card">

                    <!-- Card Data -->
                    <div class="admin-up">
                        <i class="fas fa-chart-pie light-blue lighten-1 mr-3 z-depth-2"></i>
                        <div class="data">
                            <p class="text-uppercase">Retraités </p>
                            <h4 class="font-weight-bold dark-grey-text">{{ militaire_retraite | length }}</h4>
                        </div>
                    </div>

                    <!-- Card content -->
                    <div class="card-body card-body-cascade">
                        <div class="progress mb-3">
                            {% set retraite  = (militaire_retraite|length / militaires|length)*100 %}
                            <div class="progress-bar blue lighten-2" role="progressbar" style="width: {{ en_servie|round(1, 'ceil') }}%" aria-valuenow="75"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <p class="card-text">{{ en_servie|round(1, 'ceil') }}% de l'effectif total</p>
                    </div>

                </div>
                <!-- Card -->

            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-xl-3 col-md-6 mb-0  mt-4">

                <!-- Card -->
                <div class="card card-cascade cascading-admin-card">

                    <!-- Card Data -->
                    <div class="admin-up">
                        <i class="fas fa-chart-bar red accent-2 mr-3 z-depth-2"></i>
                        <div class="data">
                            <p class="text-uppercase">Radiés</p>
                            <h4 class="font-weight-bold dark-grey-text">{{ militaire_radie | length }}</h4>
                        </div>
                    </div>

                    <!-- Card content -->
                    <div class="card-body card-body-cascade">

                        <div class="progress mb-3">
                            {% set radie  = (militaire_radie|length / militaires|length) * 100 %}
                            <div class="progress-bar red" role="progressbar" style="width: {{ radie|round(1, 'ceil') }}%" aria-valuenow="25"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <p class="card-text">{{ radie|round(1, 'ceil') }}% de l'effectif total</p>
                    </div>

                </div>
                <!-- Card -->

            </div>
            <!-- Grid column -->


            <!-- Grid column -->
            <div class="col-xl-3 col-md-6 mb-xl-0 mb-4  mt-4">

                <!-- Card -->
                <div class="card card-cascade cascading-admin-card">

                    <!-- Card Data -->
                    <div class="admin-up">
                        <i class="fas fa-users primary-color mr-3 z-depth-2"></i>
                        <div class="data">
                            <p class="text-uppercase">Autres statuts</p>
                            <h4 class="font-weight-bold dark-grey-text">{{ militaire_disponibilite | length }}</h4>
                        </div>
                    </div>

                    <!-- Card content -->
                    <div class="card-body card-body-cascade">
                        <div class="progress mb-3">
                            {% set dispo  = (militaire_disponibilite|length / militaires|length)*100 %}
                            <div class="progress-bar blue  accent-2" role="progressbar"style="width: {{ dispo|round(1, 'ceil') }}%" aria-valuenow="75"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <p class="card-text">{{ dispo|round(1, 'ceil') }}% de l'effectif total</p>
                    </div>

                </div>
                <!-- Card -->

            </div>

        </div>
        <!-- Grid row -->

    </section>


    <!-- Section: Main panel -->
    <section class="mb-5">

        <!-- Card -->
        <div class="card card-cascade narrower">

            <!-- Section: Chart -->
            <section>

                <canvas id="barChart" height="175"></canvas>

                <!-- Grid row -->

            </section>

        </div>

    </section>





        {% endblock %}

{% block botton_javascripts %}
    <script>

        $(document).ready(function () {
            //bar
            var ctxB = document.getElementById("barChart").getContext('2d');
            var myBarChart = new Chart(ctxB, {
                type: 'bar',
                data: {
                    labels: [
                        {% for corp in corp_array %}
                            "{{ corp.corps.intitule }}",
                        {% endfor %}
                    ],
                    datasets: [{
                        label: 'Effectif therorique par corps',
                        data: [
                            {% for corp in corp_array %}
                                "{{ corp.effectif }}",
                            {% endfor %}
                        ],
                        backgroundColor: [
                            {% for corp in corp_array %}
                            "#{{ corp.corps.stringToColorCode() }}",
                            {% endfor %}
                        ],
                        borderColor: [
                            {% for corp in corp_array %}
                                "#{{ corp.corps.stringToColorCode() }}",
                            {% endfor %}
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });

        })

    </script>
{% endblock %}
